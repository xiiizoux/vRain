# vRain ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—

## ğŸš€ ä¸€é”®å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ

### å¿«é€Ÿå¼€å§‹

```bash
# 1. å¯åŠ¨å®Œæ•´ç”Ÿäº§ç¯å¢ƒ
docker-compose up -d

# 2. æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps

# 3. å¼€å§‹ä½¿ç”¨
make run BOOK=01 FROM=1 TO=2 COMPRESS=1
```

## ğŸ“‹ æœåŠ¡æ¶æ„

ç”Ÿäº§ç¯å¢ƒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒæœåŠ¡ï¼š

### vrain æœåŠ¡
- **åŠŸèƒ½**: ä¸»è¦çš„ç”µå­ä¹¦ç”ŸæˆæœåŠ¡
- **å®¹å™¨å**: `vrain-app`
- **çŠ¶æ€**: æŒç»­è¿è¡Œï¼Œéšæ—¶å¯ç”¨
- **å¥åº·æ£€æŸ¥**: æ¯30ç§’æ£€æŸ¥Perlç¯å¢ƒ

### canvas æœåŠ¡
- **åŠŸèƒ½**: èƒŒæ™¯å›¾ç”ŸæˆæœåŠ¡
- **å®¹å™¨å**: `vrain-canvas`
- **çŠ¶æ€**: æŒç»­è¿è¡Œï¼Œéšæ—¶å¯ç”¨
- **å¥åº·æ£€æŸ¥**: æ¯30ç§’æ£€æŸ¥canvasç›®å½•

## ğŸ› ï¸ å¸¸ç”¨æ“ä½œ

### ç”Ÿäº§ç¯å¢ƒç®¡ç†

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
make up
# æˆ–
docker-compose up -d

# åœæ­¢æ‰€æœ‰æœåŠ¡
make down
# æˆ–
docker-compose down

# é‡å¯æœåŠ¡
make restart
# æˆ–
docker-compose restart

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
make status
# æˆ–
docker-compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
make logs
# æˆ–
docker-compose logs -f
```

### ç”µå­ä¹¦ç”Ÿæˆ

```bash
# åŸºæœ¬ç”¨æ³•
make run BOOK=01 FROM=1 TO=2 COMPRESS=1

# æµ‹è¯•æ¨¡å¼ (ä»…ç”Ÿæˆ5é¡µ)
make test BOOK=01

# è¯¦ç»†æ¨¡å¼
make run BOOK=01 FROM=1 TO=3 COMPRESS=1 VERBOSE=1

# ç›´æ¥ä½¿ç”¨docker-compose
docker-compose exec vrain perl /app/vrain.pl -b 01 -f 1 -t 2 -c
```

### èƒŒæ™¯å›¾ç”Ÿæˆ

```bash
# ç”Ÿæˆæ ‡å‡†èƒŒæ™¯å›¾
make canvas CONFIG=01_Black

# ç”Ÿæˆå®£çº¸åšæ—§é£æ ¼
make canvas-vintage CONFIG=vintage

# ç”Ÿæˆç«¹ç®€é£æ ¼
make canvas-bamboo CONFIG=bamboo

# ç›´æ¥ä½¿ç”¨docker-compose
docker-compose exec canvas perl /app/canvas/canvas.pl -c 01_Black
```

### å·¥å…·å‘½ä»¤

```bash
# æ£€æŸ¥å­—ä½“æ”¯æŒ
make fontcheck BOOK=01

# æ–‡æœ¬æ ¼å¼åŒ–
make indentxt BOOK=01

# è¿›å…¥å®¹å™¨è°ƒè¯•
make shell

# æŸ¥çœ‹vRainå¸®åŠ©
make vrain-help
```

## ğŸ“ ç›®å½•ç»“æ„

ç¡®ä¿æ‚¨çš„é¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
vRain/
â”œâ”€â”€ books/              # ä¹¦ç±æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ 01/            # ä¹¦ç±IDç›®å½•
â”‚   â”‚   â”œâ”€â”€ book.cfg   # ä¹¦ç±é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ text/      # æ–‡æœ¬æ–‡ä»¶ç›®å½•
â”‚   â”‚   â””â”€â”€ cover.jpg  # å°é¢å›¾ç‰‡
â”‚   â””â”€â”€ ...
â”œâ”€â”€ fonts/             # å­—ä½“æ–‡ä»¶ç›®å½•
â”œâ”€â”€ canvas/            # èƒŒæ™¯å›¾é…ç½®ç›®å½•
â”œâ”€â”€ tools/             # å·¥å…·è„šæœ¬ç›®å½•
â”œâ”€â”€ output/            # è¾“å‡ºç›®å½• (è‡ªåŠ¨åˆ›å»º)
â”œâ”€â”€ docker-compose.yml # ç”Ÿäº§ç¯å¢ƒé…ç½®
â””â”€â”€ Makefile          # ä¾¿æ·å‘½ä»¤
```

## ğŸ”§ é…ç½®è¯´æ˜

### å·æŒ‚è½½

ç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨æŒ‚è½½ä»¥ä¸‹ç›®å½•ï¼š

- `./books:/app/books` - ä¹¦ç±æ•°æ®
- `./fonts:/app/fonts` - å­—ä½“æ–‡ä»¶
- `./canvas:/app/canvas` - èƒŒæ™¯å›¾é…ç½®
- `./tools:/app/tools` - å·¥å…·è„šæœ¬
- `./output:/app/output` - è¾“å‡ºæ–‡ä»¶

### ç¯å¢ƒå˜é‡

- `LANG=C.UTF-8` - è¯­è¨€ç¯å¢ƒ
- `LC_ALL=C.UTF-8` - æœ¬åœ°åŒ–è®¾ç½®

### å¥åº·æ£€æŸ¥

- **æ£€æŸ¥é—´éš”**: 30ç§’
- **è¶…æ—¶æ—¶é—´**: 10ç§’
- **é‡è¯•æ¬¡æ•°**: 3æ¬¡

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   # æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
   docker-compose logs vrain
   docker-compose logs canvas
   
   # é‡æ–°æ„å»ºé•œåƒ
   docker-compose up -d --build
   ```

2. **æƒé™é—®é¢˜**
   ```bash
   # æ£€æŸ¥æ–‡ä»¶æƒé™
   ls -la books/ fonts/ canvas/
   
   # ä¿®å¤æƒé™ (å¦‚æœéœ€è¦)
   chmod -R 755 books/ fonts/ canvas/
   ```

3. **å­—ä½“æ–‡ä»¶ç¼ºå¤±**
   ```bash
   # æ£€æŸ¥å­—ä½“ç›®å½•
   ls fonts/
   
   # ç¡®ä¿å­—ä½“æ–‡ä»¶å­˜åœ¨ä¸”å¯è¯»
   ```

4. **å†…å­˜ä¸è¶³**
   ```bash
   # æ£€æŸ¥ç³»ç»Ÿèµ„æº
   docker stats
   
   # å¦‚æœéœ€è¦ï¼Œå¢åŠ Dockerå†…å­˜é™åˆ¶
   ```

### è°ƒè¯•æ¨¡å¼

```bash
# è¿›å…¥å®¹å™¨è¿›è¡Œè°ƒè¯•
make shell

# åœ¨å®¹å™¨å†…æ‰‹åŠ¨è¿è¡Œå‘½ä»¤
perl vrain.pl -b 01 -f 1 -t 1 -v
perl canvas/canvas.pl -c 01_Black
```

## ğŸ“Š æ€§èƒ½ç›‘æ§

### èµ„æºä½¿ç”¨

```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ
docker stats vrain-app vrain-canvas

# æŸ¥çœ‹é•œåƒå¤§å°
make size
```

### æ—¥å¿—ç›‘æ§

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
make logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f vrain
docker-compose logs -f canvas
```

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### æ›´æ–°é•œåƒ

```bash
# åœæ­¢æœåŠ¡
make down

# é‡æ–°æ„å»ºé•œåƒ
make build

# å¯åŠ¨æœåŠ¡
make up
```

### æ¸…ç†èµ„æº

```bash
# æ¸…ç†æ‰€æœ‰Dockerèµ„æº
make clean

# ä»…æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ
docker image prune -f
```

## ğŸ¯ ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ

1. **å®šæœŸå¤‡ä»½**: å¤‡ä»½booksç›®å½•å’Œfontsç›®å½•
2. **ç›‘æ§æ—¥å¿—**: å®šæœŸæ£€æŸ¥æœåŠ¡æ—¥å¿—
3. **èµ„æºç›‘æ§**: ç›‘æ§CPUå’Œå†…å­˜ä½¿ç”¨æƒ…å†µ
4. **æ›´æ–°ç­–ç•¥**: åœ¨éé«˜å³°æ—¶é—´è¿›è¡Œæ›´æ–°
5. **æµ‹è¯•éªŒè¯**: æ›´æ–°åè¿›è¡ŒåŠŸèƒ½æµ‹è¯•

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœåŠ¡æ—¥å¿—: `make logs`
2. æ£€æŸ¥æœåŠ¡çŠ¶æ€: `make status`
3. å°è¯•é‡å¯æœåŠ¡: `make restart`
4. é‡æ–°æ„å»ºé•œåƒ: `make down && make build && make up`

---

**æ­å–œï¼æ‚¨çš„vRainç”Ÿäº§ç¯å¢ƒå·²ç»æˆåŠŸéƒ¨ç½²ï¼** ğŸ‰
